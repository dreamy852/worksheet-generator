<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>OCR</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
</head>
<body>
    <h1>Paste image (Ctrl+V) to extract text</h1>
    <div id="status"></div>
    <div id="output"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const outputDiv = document.getElementById('output');

        document.addEventListener('paste', async (e) => {
            const items = e.clipboardData.items;
            for (let item of items) {
                if (item.type.startsWith('image/')) {
                    e.preventDefault();
                    const file = item.getAsFile();
                    await processImage(file);
                    break;
                }
            }
        });

        async function processImage(file) {
            statusDiv.textContent = 'Processing...';
            outputDiv.textContent = '';

            const worker = Tesseract.createWorker();
            
            try {
                await worker.load();
                await worker.loadLanguage('chi_tra+chi_sim+eng');
                await worker.initialize('chi_tra+chi_sim+eng');
                
                const { data: { text } } = await worker.recognize(file);
                
                outputDiv.textContent = text;
                statusDiv.textContent = 'Done';
            } catch (error) {
                statusDiv.textContent = 'Error: ' + (error.message || error);
                outputDiv.textContent = '';
            } finally {
                await worker.terminate();
            }
        }
    </script>
</body>
</html>
